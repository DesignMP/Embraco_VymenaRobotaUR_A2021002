var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
define(["require", "exports", "./CursorDefinitionBase"], function (require, exports, CursorDefinitionBase_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var CrossHairCursor = /** @class */ (function (_super) {
        __extends(CrossHairCursor, _super);
        function CrossHairCursor(cursorHandlerId, cursorIndex) {
            var _this = _super.call(this, cursorHandlerId, cursorIndex) || this;
            _this.cursorCenterOffset = 4;
            _this.crosshairId = cursorHandlerId + "crossHairCursor" + "_" + cursorIndex + "_crossHair";
            return _this;
        }
        CrossHairCursor.prototype.drawCursor = function (leadCursorPosition, cursorPositions) {
            if (leadCursorPosition != undefined && cursorPositions[0] != undefined) {
                this.cursorPositions = cursorPositions;
                this.leadCursorPosition = leadCursorPosition;
                for (var i = 0; i < cursorPositions.length; i++) {
                    this.drawCrosshair(cursorPositions[i].position, i, cursorPositions[i].additionalInformation["hovered"], cursorPositions[i].additionalInformation["highlight"], cursorPositions[i].additionalInformation["selected"]);
                }
            }
        };
        CrossHairCursor.prototype.removeCursors = function () {
            var cursorElements = document.getElementsByClassName(this.crosshairId);
            while (cursorElements[0]) {
                cursorElements[0].remove();
            }
        };
        CrossHairCursor.prototype.drawCrosshair = function (position, index, hovered, highlight, selected) {
            var svgHtml;
            var currentColor = this.cursorColor;
            if (selected) {
                currentColor = this.selectedColor;
            }
            if (hovered) {
                currentColor = this.hoverColor;
            }
            if (!highlight) {
                svgHtml = "<svg style= \"position: absolute\" class =\"" + this.crosshairId + "\" height=\"100%\" width=\"100%\">\n            <line x1=\"" + (position.x - 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y - 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y + 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y + 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            </svg>";
            }
            else {
                svgHtml = "<svg style= \"position: absolute\" class =\"" + this.crosshairId + "\" height=\"100%\" width=\"100%\">\n            <line x1=\"" + (position.x - 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y - 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y + 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y - 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y + 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x - 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            </svg>";
            }
            var cursorHandler = document.getElementById(this.cursorHandlerContainerId);
            if (cursorHandler != undefined) {
                cursorHandler.innerHTML += svgHtml;
            }
        };
        CrossHairCursor.prototype.getClosestCursorPositionToPoint = function (point) {
            var distance = undefined;
            var currentClosestCursorPosition;
            if (this.cursorPositions != undefined) {
                for (var i = 0; i < this.cursorPositions.length; i++) {
                    if (distance == undefined || distance > this.calculateDistance(this.cursorPositions[i].position, point)) {
                        distance = this.calculateDistance(this.cursorPositions[i].position, point);
                        currentClosestCursorPosition = this.cursorPositions[i];
                        currentClosestCursorPosition.additionalInformation["distance"] = distance - this.cursorCenterOffset;
                    }
                }
            }
            return currentClosestCursorPosition;
        };
        /**
         * calculate distance between two points
         *
         * @private
         * @param {IPoint} point1
         * @param {IPoint} point2
         * @returns {number}
         * @memberof CrossHairCursor
         */
        CrossHairCursor.prototype.calculateDistance = function (point1, point2) {
            return (Math.sqrt(Math.pow(point2.x - point1.x, 2) + Math.pow((point2.y - point1.y), 2)));
        };
        return CrossHairCursor;
    }(CursorDefinitionBase_1.CursorDefinitionBase));
    exports.CrossHairCursor = CrossHairCursor;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3Jvc3NIYWlyQ3Vyc29yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2FwcC93aWRnZXRzL2NoYXJ0V2lkZ2V0L2N1cnNvci9Dcm9zc0hhaXJDdXJzb3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztJQUdBO1FBQXFDLG1DQUFvQjtRQUtyRCx5QkFBWSxlQUF1QixFQUFFLFdBQW1CO1lBQXhELFlBQ0ksa0JBQU0sZUFBZSxFQUFFLFdBQVcsQ0FBQyxTQUV0QztZQUxELHdCQUFrQixHQUFXLENBQUMsQ0FBQztZQUkzQixLQUFJLENBQUMsV0FBVyxHQUFHLGVBQWUsR0FBRyxpQkFBaUIsR0FBRyxHQUFHLEdBQUcsV0FBVyxHQUFHLFlBQVksQ0FBQzs7UUFDOUYsQ0FBQztRQUVELG9DQUFVLEdBQVYsVUFBVyxrQkFBa0MsRUFBRSxlQUFpQztZQUM1RSxJQUFJLGtCQUFrQixJQUFJLFNBQVMsSUFBSSxlQUFlLENBQUMsQ0FBQyxDQUFDLElBQUksU0FBUyxFQUFFO2dCQUNwRSxJQUFJLENBQUMsZUFBZSxHQUFHLGVBQWUsQ0FBQztnQkFDdkMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLGtCQUFrQixDQUFDO2dCQUM3QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsZUFBZSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDN0MsSUFBSSxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsU0FBUyxDQUFDLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLFdBQVcsQ0FBQyxFQUFFLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO2lCQUN4TjthQUNKO1FBQ0wsQ0FBQztRQUVELHVDQUFhLEdBQWI7WUFDSSxJQUFJLGNBQWMsR0FBRyxRQUFRLENBQUMsc0JBQXNCLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBRSxDQUFDO1lBQ3hFLE9BQU8sY0FBYyxDQUFDLENBQUMsQ0FBQyxFQUFFO2dCQUN0QixjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7YUFDOUI7UUFDTCxDQUFDO1FBRU8sdUNBQWEsR0FBckIsVUFBc0IsUUFBZ0IsRUFBRSxLQUFhLEVBQUUsT0FBZ0IsRUFBRSxTQUFrQixFQUFFLFFBQWlCO1lBQzFHLElBQUksT0FBTyxDQUFDO1lBQ1osSUFBSSxZQUFZLEdBQUcsSUFBSSxDQUFDLFdBQVcsQ0FBQztZQUNwQyxJQUFJLFFBQVEsRUFBRTtnQkFDVixZQUFZLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQzthQUNyQztZQUNELElBQUcsT0FBTyxFQUFDO2dCQUNQLFlBQVksR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDO2FBQ2xDO1lBRUQsSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFDWixPQUFPLEdBQUcsOENBQTJDLEdBQUcsSUFBSSxDQUFDLFdBQVcsR0FBRyw2REFDaEUsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3pJLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUN6SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUM3SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLGlEQUU3SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3BKLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDcEosR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUNwSixHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsNENBRXhKLENBQUM7YUFDWDtpQkFDSTtnQkFDRCxPQUFPLEdBQUcsOENBQTJDLEdBQUcsSUFBSSxDQUFDLFdBQVcsR0FBRyw2REFDaEUsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3pJLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUN6SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUM3SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLGlEQUU3SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3BKLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDcEosR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUNwSixHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsNENBRXhKLENBQUM7YUFDWDtZQUNELElBQUksYUFBYSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLHdCQUF3QixDQUFDLENBQUM7WUFDM0UsSUFBRyxhQUFhLElBQUksU0FBUyxFQUFDO2dCQUMxQixhQUFjLENBQUMsU0FBUyxJQUFJLE9BQU8sQ0FBQzthQUN2QztRQUNMLENBQUM7UUFFTSx5REFBK0IsR0FBdEMsVUFBdUMsS0FBYTtZQUNoRCxJQUFJLFFBQVEsR0FBdUIsU0FBUyxDQUFDO1lBQzdDLElBQUksNEJBQTRCLENBQUM7WUFFakMsSUFBRyxJQUFJLENBQUMsZUFBZSxJQUFJLFNBQVMsRUFBQztnQkFDakMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO29CQUNsRCxJQUFJLFFBQVEsSUFBSSxTQUFTLElBQUksUUFBUSxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsRUFBRTt3QkFDckcsUUFBUSxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQzt3QkFDM0UsNEJBQTRCLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQzt3QkFDdkQsNEJBQTRCLENBQUMscUJBQXFCLENBQUMsVUFBVSxDQUFDLEdBQUcsUUFBUSxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQztxQkFDdkc7aUJBQ0o7YUFDSjtZQUNELE9BQU8sNEJBQTRCLENBQUM7UUFDeEMsQ0FBQztRQUdEOzs7Ozs7OztXQVFHO1FBQ0ssMkNBQWlCLEdBQXpCLFVBQTBCLE1BQWMsRUFBRSxNQUFjO1lBQ3BELE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUYsQ0FBQztRQUNMLHNCQUFDO0lBQUQsQ0FBQyxBQXBHRCxDQUFxQywyQ0FBb0IsR0FvR3hEO0lBcEdZLDBDQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSVBvaW50IH0gZnJvbSBcIi4uLy4uLy4uL21vZGVscy9jb21tb24vaW50ZXJmYWNlcy9wb2ludEludGVyZmFjZVwiO1xyXG5pbXBvcnQgeyBDdXJzb3JQb3NpdGlvbiB9IGZyb20gXCIuL0N1cnNvclBvc2l0aW9uSW5mb1wiO1xyXG5pbXBvcnQgeyBDdXJzb3JEZWZpbml0aW9uQmFzZSB9IGZyb20gXCIuL0N1cnNvckRlZmluaXRpb25CYXNlXCI7XHJcbmV4cG9ydCBjbGFzcyBDcm9zc0hhaXJDdXJzb3IgZXh0ZW5kcyBDdXJzb3JEZWZpbml0aW9uQmFzZSB7XHJcbiAgICBjcm9zc2hhaXJJZDtcclxuXHJcbiAgICBjdXJzb3JDZW50ZXJPZmZzZXQ6IG51bWJlciA9IDQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY3Vyc29ySGFuZGxlcklkOiBzdHJpbmcsIGN1cnNvckluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICBzdXBlcihjdXJzb3JIYW5kbGVySWQsIGN1cnNvckluZGV4KTtcclxuICAgICAgICB0aGlzLmNyb3NzaGFpcklkID0gY3Vyc29ySGFuZGxlcklkICsgXCJjcm9zc0hhaXJDdXJzb3JcIiArIFwiX1wiICsgY3Vyc29ySW5kZXggKyBcIl9jcm9zc0hhaXJcIjtcclxuICAgIH1cclxuXHJcbiAgICBkcmF3Q3Vyc29yKGxlYWRDdXJzb3JQb3NpdGlvbjogQ3Vyc29yUG9zaXRpb24sIGN1cnNvclBvc2l0aW9uczogQ3Vyc29yUG9zaXRpb25bXSkge1xyXG4gICAgICAgIGlmIChsZWFkQ3Vyc29yUG9zaXRpb24gIT0gdW5kZWZpbmVkICYmIGN1cnNvclBvc2l0aW9uc1swXSAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJzb3JQb3NpdGlvbnMgPSBjdXJzb3JQb3NpdGlvbnM7XHJcbiAgICAgICAgICAgIHRoaXMubGVhZEN1cnNvclBvc2l0aW9uID0gbGVhZEN1cnNvclBvc2l0aW9uO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN1cnNvclBvc2l0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Q3Jvc3NoYWlyKGN1cnNvclBvc2l0aW9uc1tpXS5wb3NpdGlvbiwgaSwgY3Vyc29yUG9zaXRpb25zW2ldLmFkZGl0aW9uYWxJbmZvcm1hdGlvbltcImhvdmVyZWRcIl0gLGN1cnNvclBvc2l0aW9uc1tpXS5hZGRpdGlvbmFsSW5mb3JtYXRpb25bXCJoaWdobGlnaHRcIl0sIGN1cnNvclBvc2l0aW9uc1tpXS5hZGRpdGlvbmFsSW5mb3JtYXRpb25bXCJzZWxlY3RlZFwiXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQ3Vyc29ycygpIHtcclxuICAgICAgICBsZXQgY3Vyc29yRWxlbWVudHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRoaXMuY3Jvc3NoYWlySWQpITtcclxuICAgICAgICB3aGlsZSAoY3Vyc29yRWxlbWVudHNbMF0pIHtcclxuICAgICAgICAgICAgY3Vyc29yRWxlbWVudHNbMF0ucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIGRyYXdDcm9zc2hhaXIocG9zaXRpb246IElQb2ludCwgaW5kZXg6IG51bWJlciwgaG92ZXJlZDogYm9vbGVhbiwgaGlnaGxpZ2h0OiBib29sZWFuLCBzZWxlY3RlZDogYm9vbGVhbikge1xyXG4gICAgICAgIGxldCBzdmdIdG1sO1xyXG4gICAgICAgIGxldCBjdXJyZW50Q29sb3IgPSB0aGlzLmN1cnNvckNvbG9yO1xyXG4gICAgICAgIGlmIChzZWxlY3RlZCkge1xyXG4gICAgICAgICAgICBjdXJyZW50Q29sb3IgPSB0aGlzLnNlbGVjdGVkQ29sb3I7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmKGhvdmVyZWQpe1xyXG4gICAgICAgICAgICBjdXJyZW50Q29sb3IgPSB0aGlzLmhvdmVyQ29sb3I7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWhpZ2hsaWdodCkge1xyXG4gICAgICAgICAgICBzdmdIdG1sID0gYDxzdmcgc3R5bGU9IFwicG9zaXRpb246IGFic29sdXRlXCIgY2xhc3MgPVwiYCArIHRoaXMuY3Jvc3NoYWlySWQgKyBgXCIgaGVpZ2h0PVwiMTAwJVwiIHdpZHRoPVwiMTAwJVwiPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDE0KSArIGBcIiB5MT1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54IC0gNCkgKyBgXCIgeTI9XCJgICsgcG9zaXRpb24ueSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54ICsgMTQpICsgYFwiIHkxPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA0KSArIGBcIiB5Mj1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gMTQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSAtIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55ICsgMTQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuXHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gNCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSA0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDQpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55IC0gNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDQpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55ICsgNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA0KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSA0KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54IC0gNCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54ICsgNCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSA0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDQpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG5cclxuICAgICAgICAgICAgPC9zdmc+YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHN2Z0h0bWwgPSBgPHN2ZyBzdHlsZT0gXCJwb3NpdGlvbjogYWJzb2x1dGVcIiBjbGFzcyA9XCJgICsgdGhpcy5jcm9zc2hhaXJJZCArIGBcIiBoZWlnaHQ9XCIxMDAlXCIgd2lkdGg9XCIxMDAlXCI+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gMTQpICsgYFwiIHkxPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggLSA0KSArIGBcIiB5Mj1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggKyAxNCkgKyBgXCIgeTE9XCJgICsgcG9zaXRpb24ueSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDQpICsgYFwiIHkyPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSAxNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55IC0gNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgKyAxNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSA2KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDYpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNikgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgLSA2KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gNikgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgKyA2KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDYpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNikgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDYpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gNikgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggLSA2KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDYpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggKyA2KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDYpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNikgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA2KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcblxyXG4gICAgICAgICAgICA8L3N2Zz5gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY3Vyc29ySGFuZGxlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuY3Vyc29ySGFuZGxlckNvbnRhaW5lcklkKTtcclxuICAgICAgICBpZihjdXJzb3JIYW5kbGVyICE9IHVuZGVmaW5lZCl7XHJcbiAgICAgICAgICAgIGN1cnNvckhhbmRsZXIhLmlubmVySFRNTCArPSBzdmdIdG1sO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0Q2xvc2VzdEN1cnNvclBvc2l0aW9uVG9Qb2ludChwb2ludDogSVBvaW50KTogQ3Vyc29yUG9zaXRpb24ge1xyXG4gICAgICAgIGxldCBkaXN0YW5jZTogbnVtYmVyIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIGxldCBjdXJyZW50Q2xvc2VzdEN1cnNvclBvc2l0aW9uO1xyXG5cclxuICAgICAgICBpZih0aGlzLmN1cnNvclBvc2l0aW9ucyAhPSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY3Vyc29yUG9zaXRpb25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPT0gdW5kZWZpbmVkIHx8IGRpc3RhbmNlID4gdGhpcy5jYWxjdWxhdGVEaXN0YW5jZSh0aGlzLmN1cnNvclBvc2l0aW9uc1tpXS5wb3NpdGlvbiwgcG9pbnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2UgPSB0aGlzLmNhbGN1bGF0ZURpc3RhbmNlKHRoaXMuY3Vyc29yUG9zaXRpb25zW2ldLnBvc2l0aW9uLCBwb2ludCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudENsb3Nlc3RDdXJzb3JQb3NpdGlvbiA9IHRoaXMuY3Vyc29yUG9zaXRpb25zW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDbG9zZXN0Q3Vyc29yUG9zaXRpb24uYWRkaXRpb25hbEluZm9ybWF0aW9uW1wiZGlzdGFuY2VcIl0gPSBkaXN0YW5jZSAtIHRoaXMuY3Vyc29yQ2VudGVyT2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjdXJyZW50Q2xvc2VzdEN1cnNvclBvc2l0aW9uO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIGNhbGN1bGF0ZSBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHNcclxuICAgICAqXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICogQHBhcmFtIHtJUG9pbnR9IHBvaW50MVxyXG4gICAgICogQHBhcmFtIHtJUG9pbnR9IHBvaW50MlxyXG4gICAgICogQHJldHVybnMge251bWJlcn1cclxuICAgICAqIEBtZW1iZXJvZiBDcm9zc0hhaXJDdXJzb3JcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVEaXN0YW5jZShwb2ludDE6IElQb2ludCwgcG9pbnQyOiBJUG9pbnQpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiAoTWF0aC5zcXJ0KE1hdGgucG93KHBvaW50Mi54IC0gcG9pbnQxLngsIDIpICsgTWF0aC5wb3coKHBvaW50Mi55IC0gcG9pbnQxLnkpLCAyKSkpO1xyXG4gICAgfVxyXG59XHJcbiJdfQ==