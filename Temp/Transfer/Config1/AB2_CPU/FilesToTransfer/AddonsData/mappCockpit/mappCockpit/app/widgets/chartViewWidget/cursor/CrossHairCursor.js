var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
define(["require", "exports", "./CursorDefinitionBase"], function (require, exports, CursorDefinitionBase_1) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var CrossHairCursor = /** @class */ (function (_super) {
        __extends(CrossHairCursor, _super);
        function CrossHairCursor(cursorHandlerId, cursorIndex) {
            var _this = _super.call(this, cursorHandlerId, cursorIndex) || this;
            _this.cursorCenterOffset = 4;
            _this.crosshairId = cursorHandlerId + "crossHairCursor" + "_" + cursorIndex + "_crossHair";
            return _this;
        }
        CrossHairCursor.prototype.drawCursor = function (leadCursorPosition, cursorPositions) {
            if (leadCursorPosition != undefined && cursorPositions[0] != undefined) {
                this.cursorPositions = cursorPositions;
                this.leadCursorPosition = leadCursorPosition;
                for (var i = 0; i < cursorPositions.length; i++) {
                    this.drawCrosshair(cursorPositions[i].position, i, cursorPositions[i].additionalInformation["hovered"], cursorPositions[i].additionalInformation["highlight"], cursorPositions[i].additionalInformation["selected"]);
                }
            }
        };
        CrossHairCursor.prototype.removeCursors = function () {
            var cursorElements = document.getElementsByClassName(this.crosshairId);
            while (cursorElements[0]) {
                cursorElements[0].remove();
            }
        };
        CrossHairCursor.prototype.drawCrosshair = function (position, index, hovered, highlight, selected) {
            var svgHtml;
            var currentColor = this.cursorColor;
            if (selected) {
                currentColor = this.selectedColor;
            }
            if (hovered) {
                currentColor = this.hoverColor;
            }
            if (!highlight) {
                svgHtml = "<svg style= \"position: absolute\" class =\"" + this.crosshairId + "\" height=\"100%\" width=\"100%\">\n            <line x1=\"" + (position.x - 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y - 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y + 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y + 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 4) + "\" y1=\"" + (position.y - 4) + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            </svg>";
            }
            else {
                svgHtml = "<svg style= \"position: absolute\" class =\"" + this.crosshairId + "\" height=\"100%\" width=\"100%\">\n            <line x1=\"" + (position.x - 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x - 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 14) + "\" y1=\"" + position.y + "\" x2=\"" + (position.x + 4) + "\" y2=\"" + position.y + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y - 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y - 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x) + "\" y1=\"" + (position.y + 14) + "\" x2=\"" + (position.x) + "\" y2=\"" + (position.y + 4) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y - 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y + 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x - 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x - 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n            <line x1=\"" + (position.x + 6) + "\" y1=\"" + (position.y - 6) + "\" x2=\"" + (position.x + 6) + "\" y2=\"" + (position.y + 6) + "\" style=\"stroke:" + currentColor + ";stroke-width:2\" />\n\n            </svg>";
            }
            var cursorHandler = document.getElementById(this.cursorHandlerContainerId);
            if (cursorHandler != undefined) {
                cursorHandler.innerHTML += svgHtml;
            }
        };
        CrossHairCursor.prototype.getClosestCursorPositionToPoint = function (point) {
            var distance = undefined;
            var currentClosestCursorPosition;
            if (this.cursorPositions != undefined) {
                for (var i = 0; i < this.cursorPositions.length; i++) {
                    if (distance == undefined || distance > this.calculateDistance(this.cursorPositions[i].position, point)) {
                        distance = this.calculateDistance(this.cursorPositions[i].position, point);
                        currentClosestCursorPosition = this.cursorPositions[i];
                        currentClosestCursorPosition.additionalInformation["distance"] = distance - this.cursorCenterOffset;
                    }
                }
            }
            return currentClosestCursorPosition;
        };
        /**
         * calculate distance between two points
         *
         * @private
         * @param {IPoint} point1
         * @param {IPoint} point2
         * @returns {number}
         * @memberof CrossHairCursor
         */
        CrossHairCursor.prototype.calculateDistance = function (point1, point2) {
            return (Math.sqrt(Math.pow(point2.x - point1.x, 2) + Math.pow((point2.y - point1.y), 2)));
        };
        return CrossHairCursor;
    }(CursorDefinitionBase_1.CursorDefinitionBase));
    exports.CrossHairCursor = CrossHairCursor;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ3Jvc3NIYWlyQ3Vyc29yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vc3JjL2FwcC93aWRnZXRzL2NoYXJ0Vmlld1dpZGdldC9jdXJzb3IvQ3Jvc3NIYWlyQ3Vyc29yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7SUFHQTtRQUFxQyxtQ0FBb0I7UUFLckQseUJBQVksZUFBdUIsRUFBRSxXQUFtQjtZQUF4RCxZQUNJLGtCQUFNLGVBQWUsRUFBRSxXQUFXLENBQUMsU0FFdEM7WUFMRCx3QkFBa0IsR0FBVyxDQUFDLENBQUM7WUFJM0IsS0FBSSxDQUFDLFdBQVcsR0FBRyxlQUFlLEdBQUcsaUJBQWlCLEdBQUcsR0FBRyxHQUFHLFdBQVcsR0FBRyxZQUFZLENBQUM7O1FBQzlGLENBQUM7UUFFRCxvQ0FBVSxHQUFWLFVBQVcsa0JBQWtDLEVBQUUsZUFBaUM7WUFDNUUsSUFBSSxrQkFBa0IsSUFBSSxTQUFTLElBQUksZUFBZSxDQUFDLENBQUMsQ0FBQyxJQUFJLFNBQVMsRUFBRTtnQkFDcEUsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7Z0JBQ3ZDLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxrQkFBa0IsQ0FBQztnQkFDN0MsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLGVBQWUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7b0JBQzdDLElBQUksQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxFQUFFLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxXQUFXLENBQUMsRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUMscUJBQXFCLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztpQkFDeE47YUFDSjtRQUNMLENBQUM7UUFFRCx1Q0FBYSxHQUFiO1lBQ0ksSUFBSSxjQUFjLEdBQUcsUUFBUSxDQUFDLHNCQUFzQixDQUFDLElBQUksQ0FBQyxXQUFXLENBQUUsQ0FBQztZQUN4RSxPQUFPLGNBQWMsQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDdEIsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO2FBQzlCO1FBQ0wsQ0FBQztRQUVPLHVDQUFhLEdBQXJCLFVBQXNCLFFBQWdCLEVBQUUsS0FBYSxFQUFFLE9BQWdCLEVBQUUsU0FBa0IsRUFBRSxRQUFpQjtZQUMxRyxJQUFJLE9BQU8sQ0FBQztZQUNaLElBQUksWUFBWSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUM7WUFDcEMsSUFBSSxRQUFRLEVBQUU7Z0JBQ1YsWUFBWSxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUM7YUFDckM7WUFDRCxJQUFHLE9BQU8sRUFBQztnQkFDUCxZQUFZLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQzthQUNsQztZQUVELElBQUksQ0FBQyxTQUFTLEVBQUU7Z0JBQ1osT0FBTyxHQUFHLDhDQUEyQyxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsNkRBQ2hFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUN6SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxVQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDekksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRyxpREFFN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUNwSixHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3BKLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDcEosR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLDRDQUV4SixDQUFDO2FBQ1g7aUJBQ0k7Z0JBQ0QsT0FBTyxHQUFHLDhDQUEyQyxHQUFHLElBQUksQ0FBQyxXQUFXLEdBQUcsNkRBQ2hFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLFFBQVEsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUN6SSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxVQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxRQUFRLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDekksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRyxpREFFN0ksR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLCtDQUNwSixHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxvQkFBa0IsR0FBRyxZQUFZLEdBQUcsK0NBQ3BKLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLG9CQUFrQixHQUFHLFlBQVksR0FBRywrQ0FDcEosR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsVUFBUSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxVQUFRLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFVBQVEsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsb0JBQWtCLEdBQUcsWUFBWSxHQUFHLDRDQUV4SixDQUFDO2FBQ1g7WUFDRCxJQUFJLGFBQWEsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1lBQzNFLElBQUcsYUFBYSxJQUFJLFNBQVMsRUFBQztnQkFDMUIsYUFBYyxDQUFDLFNBQVMsSUFBSSxPQUFPLENBQUM7YUFDdkM7UUFDTCxDQUFDO1FBRU0seURBQStCLEdBQXRDLFVBQXVDLEtBQWE7WUFDaEQsSUFBSSxRQUFRLEdBQXVCLFNBQVMsQ0FBQztZQUM3QyxJQUFJLDRCQUE0QixDQUFDO1lBRWpDLElBQUcsSUFBSSxDQUFDLGVBQWUsSUFBSSxTQUFTLEVBQUM7Z0JBQ2pDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDbEQsSUFBSSxRQUFRLElBQUksU0FBUyxJQUFJLFFBQVEsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsS0FBSyxDQUFDLEVBQUU7d0JBQ3JHLFFBQVEsR0FBRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsS0FBSyxDQUFDLENBQUM7d0JBQzNFLDRCQUE0QixHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUM7d0JBQ3ZELDRCQUE0QixDQUFDLHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxHQUFHLFFBQVEsR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUM7cUJBQ3ZHO2lCQUNKO2FBQ0o7WUFDRCxPQUFPLDRCQUE0QixDQUFDO1FBQ3hDLENBQUM7UUFHRDs7Ozs7Ozs7V0FRRztRQUNLLDJDQUFpQixHQUF6QixVQUEwQixNQUFjLEVBQUUsTUFBYztZQUNwRCxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlGLENBQUM7UUFDTCxzQkFBQztJQUFELENBQUMsQUFwR0QsQ0FBcUMsMkNBQW9CLEdBb0d4RDtJQXBHWSwwQ0FBZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElQb2ludCB9IGZyb20gXCIuLi8uLi8uLi9tb2RlbHMvY29tbW9uL2ludGVyZmFjZXMvcG9pbnRJbnRlcmZhY2VcIjtcclxuaW1wb3J0IHsgQ3Vyc29yUG9zaXRpb24gfSBmcm9tIFwiLi9DdXJzb3JQb3NpdGlvbkluZm9cIjtcclxuaW1wb3J0IHsgQ3Vyc29yRGVmaW5pdGlvbkJhc2UgfSBmcm9tIFwiLi9DdXJzb3JEZWZpbml0aW9uQmFzZVwiO1xyXG5leHBvcnQgY2xhc3MgQ3Jvc3NIYWlyQ3Vyc29yIGV4dGVuZHMgQ3Vyc29yRGVmaW5pdGlvbkJhc2Uge1xyXG4gICAgY3Jvc3NoYWlySWQ7XHJcblxyXG4gICAgY3Vyc29yQ2VudGVyT2Zmc2V0OiBudW1iZXIgPSA0O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGN1cnNvckhhbmRsZXJJZDogc3RyaW5nLCBjdXJzb3JJbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgc3VwZXIoY3Vyc29ySGFuZGxlcklkLCBjdXJzb3JJbmRleCk7XHJcbiAgICAgICAgdGhpcy5jcm9zc2hhaXJJZCA9IGN1cnNvckhhbmRsZXJJZCArIFwiY3Jvc3NIYWlyQ3Vyc29yXCIgKyBcIl9cIiArIGN1cnNvckluZGV4ICsgXCJfY3Jvc3NIYWlyXCI7XHJcbiAgICB9XHJcblxyXG4gICAgZHJhd0N1cnNvcihsZWFkQ3Vyc29yUG9zaXRpb246IEN1cnNvclBvc2l0aW9uLCBjdXJzb3JQb3NpdGlvbnM6IEN1cnNvclBvc2l0aW9uW10pIHtcclxuICAgICAgICBpZiAobGVhZEN1cnNvclBvc2l0aW9uICE9IHVuZGVmaW5lZCAmJiBjdXJzb3JQb3NpdGlvbnNbMF0gIT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3Vyc29yUG9zaXRpb25zID0gY3Vyc29yUG9zaXRpb25zO1xyXG4gICAgICAgICAgICB0aGlzLmxlYWRDdXJzb3JQb3NpdGlvbiA9IGxlYWRDdXJzb3JQb3NpdGlvbjtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjdXJzb3JQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZHJhd0Nyb3NzaGFpcihjdXJzb3JQb3NpdGlvbnNbaV0ucG9zaXRpb24sIGksIGN1cnNvclBvc2l0aW9uc1tpXS5hZGRpdGlvbmFsSW5mb3JtYXRpb25bXCJob3ZlcmVkXCJdICxjdXJzb3JQb3NpdGlvbnNbaV0uYWRkaXRpb25hbEluZm9ybWF0aW9uW1wiaGlnaGxpZ2h0XCJdLCBjdXJzb3JQb3NpdGlvbnNbaV0uYWRkaXRpb25hbEluZm9ybWF0aW9uW1wic2VsZWN0ZWRcIl0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUN1cnNvcnMoKSB7XHJcbiAgICAgICAgbGV0IGN1cnNvckVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0aGlzLmNyb3NzaGFpcklkKSE7XHJcbiAgICAgICAgd2hpbGUgKGN1cnNvckVsZW1lbnRzWzBdKSB7XHJcbiAgICAgICAgICAgIGN1cnNvckVsZW1lbnRzWzBdLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBkcmF3Q3Jvc3NoYWlyKHBvc2l0aW9uOiBJUG9pbnQsIGluZGV4OiBudW1iZXIsIGhvdmVyZWQ6IGJvb2xlYW4sIGhpZ2hsaWdodDogYm9vbGVhbiwgc2VsZWN0ZWQ6IGJvb2xlYW4pIHtcclxuICAgICAgICBsZXQgc3ZnSHRtbDtcclxuICAgICAgICBsZXQgY3VycmVudENvbG9yID0gdGhpcy5jdXJzb3JDb2xvcjtcclxuICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgY3VycmVudENvbG9yID0gdGhpcy5zZWxlY3RlZENvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihob3ZlcmVkKXtcclxuICAgICAgICAgICAgY3VycmVudENvbG9yID0gdGhpcy5ob3ZlckNvbG9yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFoaWdobGlnaHQpIHtcclxuICAgICAgICAgICAgc3ZnSHRtbCA9IGA8c3ZnIHN0eWxlPSBcInBvc2l0aW9uOiBhYnNvbHV0ZVwiIGNsYXNzID1cImAgKyB0aGlzLmNyb3NzaGFpcklkICsgYFwiIGhlaWdodD1cIjEwMCVcIiB3aWR0aD1cIjEwMCVcIj5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSAxNCkgKyBgXCIgeTE9XCJgICsgcG9zaXRpb24ueSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCAtIDQpICsgYFwiIHkyPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCArIDE0KSArIGBcIiB5MT1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNCkgKyBgXCIgeTI9XCJgICsgcG9zaXRpb24ueSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDE0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgLSA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSArIDE0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcblxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDQpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA0KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSAtIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSA0KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSArIDQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54ICsgNCkgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA0KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gNCkgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSA0KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCAtIDQpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNCkgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCArIDQpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gNCkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA0KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuXHJcbiAgICAgICAgICAgIDwvc3ZnPmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzdmdIdG1sID0gYDxzdmcgc3R5bGU9IFwicG9zaXRpb246IGFic29sdXRlXCIgY2xhc3MgPVwiYCArIHRoaXMuY3Jvc3NoYWlySWQgKyBgXCIgaGVpZ2h0PVwiMTAwJVwiIHdpZHRoPVwiMTAwJVwiPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDE0KSArIGBcIiB5MT1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54IC0gNCkgKyBgXCIgeTI9XCJgICsgcG9zaXRpb24ueSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54ICsgMTQpICsgYFwiIHkxPVwiYCArIHBvc2l0aW9uLnkgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA0KSArIGBcIiB5Mj1cImAgKyBwb3NpdGlvbi55ICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55IC0gMTQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSAtIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLngpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55ICsgMTQpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDQpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuXHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54IC0gNikgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSA2KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDYpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55IC0gNikgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG4gICAgICAgICAgICA8bGluZSB4MT1cImAgKyAocG9zaXRpb24ueCAtIDYpICsgYFwiIHkxPVwiYCArIChwb3NpdGlvbi55ICsgNikgKyBgXCIgeDI9XCJgICsgKHBvc2l0aW9uLnggKyA2KSArIGBcIiB5Mj1cImAgKyAocG9zaXRpb24ueSArIDYpICsgYFwiIHN0eWxlPVwic3Ryb2tlOmAgKyBjdXJyZW50Q29sb3IgKyBgO3N0cm9rZS13aWR0aDoyXCIgLz5cclxuICAgICAgICAgICAgPGxpbmUgeDE9XCJgICsgKHBvc2l0aW9uLnggLSA2KSArIGBcIiB5MT1cImAgKyAocG9zaXRpb24ueSAtIDYpICsgYFwiIHgyPVwiYCArIChwb3NpdGlvbi54IC0gNikgKyBgXCIgeTI9XCJgICsgKHBvc2l0aW9uLnkgKyA2KSArIGBcIiBzdHlsZT1cInN0cm9rZTpgICsgY3VycmVudENvbG9yICsgYDtzdHJva2Utd2lkdGg6MlwiIC8+XHJcbiAgICAgICAgICAgIDxsaW5lIHgxPVwiYCArIChwb3NpdGlvbi54ICsgNikgKyBgXCIgeTE9XCJgICsgKHBvc2l0aW9uLnkgLSA2KSArIGBcIiB4Mj1cImAgKyAocG9zaXRpb24ueCArIDYpICsgYFwiIHkyPVwiYCArIChwb3NpdGlvbi55ICsgNikgKyBgXCIgc3R5bGU9XCJzdHJva2U6YCArIGN1cnJlbnRDb2xvciArIGA7c3Ryb2tlLXdpZHRoOjJcIiAvPlxyXG5cclxuICAgICAgICAgICAgPC9zdmc+YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGN1cnNvckhhbmRsZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmN1cnNvckhhbmRsZXJDb250YWluZXJJZCk7XHJcbiAgICAgICAgaWYoY3Vyc29ySGFuZGxlciAhPSB1bmRlZmluZWQpe1xyXG4gICAgICAgICAgICBjdXJzb3JIYW5kbGVyIS5pbm5lckhUTUwgKz0gc3ZnSHRtbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldENsb3Nlc3RDdXJzb3JQb3NpdGlvblRvUG9pbnQocG9pbnQ6IElQb2ludCk6IEN1cnNvclBvc2l0aW9uIHtcclxuICAgICAgICBsZXQgZGlzdGFuY2U6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcclxuICAgICAgICBsZXQgY3VycmVudENsb3Nlc3RDdXJzb3JQb3NpdGlvbjtcclxuXHJcbiAgICAgICAgaWYodGhpcy5jdXJzb3JQb3NpdGlvbnMgIT0gdW5kZWZpbmVkKXtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmN1cnNvclBvc2l0aW9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGRpc3RhbmNlID09IHVuZGVmaW5lZCB8fCBkaXN0YW5jZSA+IHRoaXMuY2FsY3VsYXRlRGlzdGFuY2UodGhpcy5jdXJzb3JQb3NpdGlvbnNbaV0ucG9zaXRpb24sIHBvaW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gdGhpcy5jYWxjdWxhdGVEaXN0YW5jZSh0aGlzLmN1cnNvclBvc2l0aW9uc1tpXS5wb3NpdGlvbiwgcG9pbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDbG9zZXN0Q3Vyc29yUG9zaXRpb24gPSB0aGlzLmN1cnNvclBvc2l0aW9uc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2xvc2VzdEN1cnNvclBvc2l0aW9uLmFkZGl0aW9uYWxJbmZvcm1hdGlvbltcImRpc3RhbmNlXCJdID0gZGlzdGFuY2UgLSB0aGlzLmN1cnNvckNlbnRlck9mZnNldDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY3VycmVudENsb3Nlc3RDdXJzb3JQb3NpdGlvbjtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBjYWxjdWxhdGUgZGlzdGFuY2UgYmV0d2VlbiB0d28gcG9pbnRzXHJcbiAgICAgKlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqIEBwYXJhbSB7SVBvaW50fSBwb2ludDFcclxuICAgICAqIEBwYXJhbSB7SVBvaW50fSBwb2ludDJcclxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9XHJcbiAgICAgKiBAbWVtYmVyb2YgQ3Jvc3NIYWlyQ3Vyc29yXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY2FsY3VsYXRlRGlzdGFuY2UocG9pbnQxOiBJUG9pbnQsIHBvaW50MjogSVBvaW50KTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gKE1hdGguc3FydChNYXRoLnBvdyhwb2ludDIueCAtIHBvaW50MS54LCAyKSArIE1hdGgucG93KChwb2ludDIueSAtIHBvaW50MS55KSwgMikpKTtcclxuICAgIH1cclxufVxyXG4iXX0=